<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <style>
    .root {
      height: 400px;
      width: 400px;
      border: 1px solid black;
      overflow-y: scroll;
    }
    .root .box {
      position: relative;
      width: 400px;
      height: 900px;
      border: 1px solid red;
    }
    .root .box .targetTop{
      position: absolute;
      top: 100px;
      width: 50px;
      height: 50px;
      background-color: red;
    }
    
    .root .box .target{
      /* opacity: 0; */
      position: absolute;
      bottom: 100px;
      width: 50px;
      height: 50px;
      background-color: aqua;
    }
    .root .box .target1{
      /* opacity: 0; */
      position: absolute;
      bottom: 100px;
      left: 100px;
      width: 50px;
      height: 50px;
      background-color: aqua;
    }
    .root .box .target2{
      /* opacity: 0; */
      position: absolute;
      bottom: 0;
      width: 50px;
      height: 50px;
      background-color: blue;
    }

    .root .box .move{
      /* opacity: 0; */
      position: absolute;
      top: 100px;
      right: 100px;
      width: 50px;
      height: 50px;
      background-color: palegoldenrod;
      transition: right 3s;
    }
  </style>
</head>

<body>
  <div class="root">
    <button onClick="moveto()">handle</button>
    <div class="box">
      <div class="targetTop"  id="1"></div>

      <div class="target"  id="1"></div>
      <div class="target1" id="2"></div>
      <div class="target2" id="3"></div>

      <div class="move"0></div>
    </div>
  </div>
  <script>
function moveto(){
  let el = document.querySelector('.move')
  el.style.right='320px'
  console.log('~~');
}
    ((doc) => {
      let n = 0
      //Ëé∑ÂèñÁõÆÊ†áÂÖÉÁ¥†
      const targetTop = doc.querySelector(".targetTop")

      const target = doc.querySelector(".target")
      const target1 = doc.querySelector(".target1")
      const target2 = doc.querySelector(".target2")
      //Ëé∑ÂèñÊ†πÂÖÉÁ¥†
      const root = doc.querySelector(".root")
      //ÂõûË∞ÉÂáΩÊï∞
      const callback = (entries, observer) => {
        n++
          console.log('callback ÊâßË°å');
        // if(entries[0].isIntersecting){
          // isVisible
          // isIntersecting
          console.log(`üê¥üê¥~ ÊâßË°å‰∫Ü ${n} Ê¨°callback`);
        console.log('üê¥üê¥~ entries:', entries);
        console.log('üê¥üê¥~ observer:', observer);
        // entries.forEach(item => {
        // console.log(item.target.id);
      console.log(observer.takeRecords());
          
        // });
        // }

      };
      //ÈÖçÁΩÆÂØπË±°
      const options = {
        root: root,
        // rootMargin: '0px 0px 0px 0px',
        rootMargin: '0px 0px 0px 0px',
        threshold: [1],
        trackVisibility: true,
        delay: 100
      };
      //ÂàõÂª∫ËßÇÂØüÂô®
      const myObserver = new IntersectionObserver(callback, options);
      //ÂºÄÂßãÁõëÂê¨ÁõÆÊ†áÂÖÉÁ¥†
      myObserver.observe(targetTop);
      myObserver.observe(target);
      myObserver.observe(target1);
      myObserver.observe(target2);
      // console.log('üê¥üê¥~ myObserver:', myObserver);
    })(document)
  </script>
</body>

</html>